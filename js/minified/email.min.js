function openModal(){document.getElementById("modal").style.display="flex"}function nextStep(){validarStep1()&&(document.querySelectorAll("#booking-form input, #booking-form select, #booking-form textarea").forEach(e=>{e.style.borderBottom="1px solid #ccc";e=document.getElementById("error-"+e.id);e&&(e.textContent="")}),document.getElementById("step1").classList.remove("active"),document.getElementById("step1").style.display="none",document.getElementById("step2").classList.add("active"),document.getElementById("step2").style.display="flex")}function prevStep(){document.querySelectorAll("#step2 input, #step2 select, #step2 textarea").forEach(e=>{var t=document.getElementById("error-"+e.id);t&&(t.textContent=""),e.style.borderBottom="1px solid #ccc"}),document.getElementById("step2").classList.remove("active"),document.getElementById("step2").style.display="none",document.getElementById("step1").classList.add("active"),document.getElementById("step1").style.display="flex"}function closeModal(){document.getElementById("modal").style.display="none",resetFormulario()}function resetFormulario(){document.getElementById("booking-form").reset(),document.querySelectorAll("#booking-form input, #booking-form select, #booking-form textarea").forEach(e=>{e.style.borderBottom="1px solid #ccc";e=document.getElementById("error-"+e.id);e&&(e.textContent="")}),document.getElementById("step1").style.display="flex",document.getElementById("step2").style.display="none",document.getElementById("step3").style.display="none"}function mostrarError(e,t){var o=document.getElementById(e),e=document.getElementById("error-"+e);t?(o.style.borderBottom="1px solid red",e.textContent=t,e.style.color="red"):(o.style.borderBottom="1px solid #ccc",e.textContent="")}function validarStep1(){let t=!0;if([{id:"nombre",valor:document.getElementById("nombre").value.trim()},{id:"fecha_nacimiento",valor:document.getElementById("fecha_nacimiento").value.trim()},{id:"email",valor:document.getElementById("email").value.trim()},{id:"telefono",valor:document.getElementById("telefono").value.trim()}].forEach(e=>{""===e.valor?(mostrarError(e.id,"Este campo es obligatorio"),t=!1):mostrarError(e.id,"")}),!t)return!1;/^[a-zA-Z\s]+$/.test(document.getElementById("nombre").value.trim())||(mostrarError("nombre","El nombre solo puede contener letras y espacios"),t=!1),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(document.getElementById("email").value.trim())||(mostrarError("email","Ingrese un email válido (ejemplo@correo.com)"),t=!1),/^\+?[0-9\s]{7,15}$/.test(document.getElementById("telefono").value.trim())||(mostrarError("telefono","Ingrese un número válido"),t=!1);var e=new Date(document.getElementById("fecha_nacimiento").value),o=new Date;let n=o.getFullYear()-e.getFullYear();var l=o.getMonth()-e.getMonth();return(l<0||0==l&&o.getDate()<e.getDate())&&n--,(isNaN(n)||n<18)&&(mostrarError("fecha_nacimiento","Debes ser mayor de 18 años"),t=!1),t}function validarStep2(){var e=[{id:"estilo",valor:document.getElementById("estilo").value.trim()},{id:"idea",valor:document.getElementById("idea").value.trim()},{id:"ubicacion",valor:document.getElementById("ubicacion").value.trim()},{id:"tamano",valor:document.getElementById("tamano").value.trim()}];let t=!0;return e.forEach(e=>{""===document.getElementById(e.id).value.trim()?(mostrarError(e.id,"Este campo es obligatorio"),t=!1):mostrarError(e.id,"")}),t}function enviarFormulario(){let t=document.getElementById("btn-enviar"),o=(t.classList.add("sending"),t.disabled=!0,performance.now());var e={nombre:document.getElementById("nombre").value,email:document.getElementById("email").value,fecha_nacimiento:document.getElementById("fecha_nacimiento").value,telefono:document.getElementById("telefono").value,estilo:document.getElementById("estilo").value,idea:document.getElementById("idea").value,ubicacion:document.getElementById("ubicacion").value,tamano:document.getElementById("tamano").value};emailjs.send("service_3x5pasi","template_vhk0bdh",e).then(()=>{var e=(performance.now()-o)/1e3;t.style.transition=`transform ${e}s ease-in-out`,setTimeout(()=>{t.classList.remove("sending"),document.getElementById("step1").style.display="nonegi",document.getElementById("step2").style.display="none",document.getElementById("step3").style.display="flex",document.getElementById("form-title").style.display="none",document.getElementById("step3").classList.add("active")},e)},e=>{alert("Error al enviar el formulario"),console.error(e)})}emailjs.init("TbA2rng_e_Kc0G62J"),(btn_book=document.getElementById("btn-book")).addEventListener("click",openModal),btn_close=document.getElementById("close-modal"),modal_overlay=document.querySelector(".modal-overlay"),btn_back=document.getElementById("back-btn"),btn_next=document.getElementById("btn-next"),modal_overlay.addEventListener("click",closeModal),btn_back.addEventListener("click",prevStep),btn_next.addEventListener("click",nextStep),btn_close.addEventListener("click",closeModal),document.getElementById("booking-form").addEventListener("submit",function(e){e.preventDefault(),validarStep2()&&(document.getElementById("honeypot").value?(console.warn("Spam detectado. Formulario bloqueado."),e.preventDefault()):enviarFormulario())});